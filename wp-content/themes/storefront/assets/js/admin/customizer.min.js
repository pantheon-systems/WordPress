!function(n,s){"use strict";if(n&&n.customize){var o=n.customize;o.SFGuidedTourSteps=[],"undefined"!=typeof _wpCustomizeSFGuidedTourSteps&&s.extend(o.SFGuidedTourSteps,_wpCustomizeSFGuidedTourSteps),o.SFGuidedTour={$container:null,currentStep:-1,init:function(){this._setupUI()},_setupUI:function(){var t=this,e=s("body.wp-customizer .wp-full-overlay");this.$container=s("<div/>").addClass("sf-guided-tour"),e.prepend(this.$container),this._addListeners(),this.$container.css(s("body").hasClass("rtl")?"right":"left",s("#customize-controls").width()+10+"px").on("transitionend",function(){t.$container.addClass("sf-loaded")}),this._showNextStep(),s(document).on("click",".sf-guided-tour-step .sf-nux-button",function(){return t._showNextStep(),!1}),s(document).on("click",".sf-guided-tour-step .sf-guided-tour-skip",function(){return 0===t.currentStep?t._hideTour(!0):t._showNextStep(),!1})},_addListeners:function(){var t=this;o.state("expandedSection").bind(function(){t._adjustPosition()}),o.state("expandedPanel").bind(function(){t._adjustPosition()})},_adjustPosition:function(){var t=this._getCurrentStep(),e=o.state("expandedSection").get(),n=o.state("expandedPanel").get();if(t)if(this.$container.removeClass("sf-inside-section"),e&&t.section===e.id)this._moveContainer(s(e.container[1]).find(".customize-section-title")),this.$container.addClass("sf-inside-section");else if(!1===e&&!1===n)if(this._isTourHidden())this._revealTour();else{var i=this._getSelector(t.section);this._moveContainer(i)}else this._hideTour()},_hideTour:function(t){var e=this;this._isTourHidden()||(this.$container.css({transform:"",top:this.$container.offset().top}),s("body").addClass("sf-exiting").on("animationend.storefront webkitAnimationEnd.storefront",function(){s(this).removeClass("sf-exiting").off("animationend.storefront webkitAnimationEnd.storefront").addClass("sf-hidden"),e.$container.hide(),_.isUndefined(t)||!0!==t||e._removeTour()}))},_revealTour:function(){var t=this;s("body").removeClass("sf-hidden"),t.$container.show(),s("body").addClass("sf-entering").on("animationend.storefront webkitAnimationEnd.storefront",function(){s(this).removeClass("sf-entering").off("animationend.storefront webkitAnimationEnd.storefront"),t.$container.css({top:"auto",transform:"translateY("+parseInt(t.$container.offset().top,10)+"px)"})})},_removeTour:function(){this.$container.remove()},_closeAllSections:function(){o.section.each(function(t){t.collapse({duration:0})}),o.panel.each(function(t){t.collapse({duration:0})})},_showNextStep:function(){var t,e;this._isLastStep()?this._hideTour(!0):(this._closeAllSections(),(t=this._getNextStep()).message=this._lineBreaksToParagraphs(t.message),e=n.template("sf-guided-tour-step"),this.$container.removeClass("sf-first-step"),0===this.currentStep&&(t.first_step=!0,this.$container.addClass("sf-first-step")),this._isLastStep()&&(t.last_step=!0,this.$container.addClass("sf-last-step")),this._moveContainer(this._getSelector(t.section)),this.$container.html(e(t)))},_moveContainer:function(t){var e,n=this;t&&(e=parseInt(t.offset().top,10)+t.height()/2-44,this.$container.addClass("sf-moving").css({transform:"translateY("+parseInt(e,10)+"px)"}).on("transitionend.storefront",function(){n.$container.removeClass("sf-moving"),n.$container.off("transitionend.storefront")}))},_getSelector:function(t){var e=o.section(t)?o.section(t):o.panel(t);return _.isUndefined(e)?s(t):s(e.container[0])},_getCurrentStep:function(){return o.SFGuidedTourSteps[this.currentStep]},_getNextStep:function(){return this.currentStep=this.currentStep+1,o.SFGuidedTourSteps[this.currentStep]},_isTourHidden:function(){return!!s("body").hasClass("sf-hidden")},_isLastStep:function(){return!(this.currentStep+1<o.SFGuidedTourSteps.length)},_lineBreaksToParagraphs:function(t){return"<p>"+t.replace("\n\n","</p><p>")+"</p>"}},s(document).ready(function(){o.SFGuidedTour.init()})}}(window.wp,jQuery);